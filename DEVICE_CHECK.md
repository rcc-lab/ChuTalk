# デバイスとアカウントの確認手順

**作成日時**: 2025年10月10日 00:40
**重要**: 正しいデバイスでテストしているか確認してください

---

## 問題

Xcodeに接続されているデバイスのログに以下が表示されています：

```
🔵 SocketService: User ID: 11
🔵 SocketService: Registering user - userId: 11
```

これは、**User 11としてログインしている**ことを示しています。

しかし、着信テストでは**User 10が着信を受ける必要**があります。

---

## 確認手順

### ステップ1: 各デバイスのログイン状態を確認

#### デバイス1（iPhone 1）

1. アプリを起動
2. 画面の右上に表示される**ユーザー名**を確認
3. または、設定画面でユーザー名を確認

**質問**:
- ユーザー名は何ですか？ `rcc122` または `rcc123` ？
- ユーザーIDは何ですか？ `10` または `11` ？

#### デバイス2（iPhone 2）

1. アプリを起動
2. 画面の右上に表示される**ユーザー名**を確認
3. または、設定画面でユーザー名を確認

**質問**:
- ユーザー名は何ですか？ `rcc122` または `rcc123` ？
- ユーザーIDは何ですか？ `10` または `11` ？

---

### ステップ2: Xcodeに接続されているデバイスを確認

1. Xcodeウィンドウの上部を確認
2. デバイス名が表示されています（例: "iPhone 14 Pro"）
3. そのデバイスの**ログイン中のユーザー名**を確認

**確認方法**:
- Xcodeコンソールで `User ID:` を検索
- 表示される番号を確認（`10` または `11`）

---

### ステップ3: 正しい設定でテスト

**着信テスト**では：
- **発信側**: User 11（rcc122）
- **受信側**: User 10（rcc123）← **このデバイスをXcodeに接続**

**手順**:

1. **User 10（rcc123）のデバイス**をXcodeに接続
2. Xcodeコンソールをクリア
3. Xcodeコンソールで `User ID:` を検索
4. `User ID: 10` と表示されることを確認 ← **重要**
5. User 11から発信
6. User 10のコンソールで `Received offer` を確認

---

## 現在のログから判明したこと

### Xcodeに接続されているデバイス

```
🔵 SocketService: User ID: 11
```

→ このデバイスは **User 11** としてログインしています

### 発信と着信の関係

```
🔵 SocketService: Sending offer to 10
✅ SocketService: Offer sent
```

→ User 11 が User 10 に Offer を送信しています

### 問題

User 11のデバイスをXcodeに接続していると、**User 10が着信を受けた時のログが表示されません。**

**解決策**: User 10のデバイスをXcodeに接続してください。

---

## トラブルシューティング

### Q1: 両方のデバイスが同じアカウントにログインしている場合

**症状**:
- 両方のデバイスで同じユーザー名が表示される
- 片方から発信しても、もう片方で着信しない

**原因**:
- 同じアカウントに2つのデバイスがログインしている
- Signal Serverは1つのユーザーIDに対して最後に接続したデバイスにのみ配信する

**解決方法**:

1. **デバイス1でログアウト**:
   - 設定 → ログアウト

2. **デバイス1で User 11 にログイン**:
   - ユーザー名: `rcc122`
   - パスワード: [User 11のパスワード]

3. **デバイス2でログアウト**:
   - 設定 → ログアウト

4. **デバイス2で User 10 にログイン**:
   - ユーザー名: `rcc123`
   - パスワード: [User 10のパスワード]

5. **確認**:
   - デバイス1: `User ID: 11` と表示される
   - デバイス2: `User ID: 10` と表示される

---

### Q2: Xcodeに接続するデバイスを切り替える方法

**手順**:

1. Xcodeメニュー → Window → Devices and Simulators
2. 左側のリストで接続されているデバイスを確認
3. User 10のデバイスを選択
4. Xcodeのツールバーでデバイスを選択
5. Product → Run (Cmd + R) でアプリを起動
6. コンソールで `User ID: 10` と表示されることを確認

---

## 次のアクション

1. **各デバイスのログイン状態を確認**
   - [ ] デバイス1: ユーザー名 = _______, ユーザーID = _______
   - [ ] デバイス2: ユーザー名 = _______, ユーザーID = _______

2. **Xcodeに接続されているデバイスを確認**
   - [ ] Xcodeコンソールで `User ID: 10` と表示されている

3. **着信テストを実施**
   - [ ] User 11から発信
   - [ ] User 10のコンソールで `🔵 CallManager: Received offer` が表示される

4. **結果を報告**
   - Xcodeに接続されているデバイスのユーザーID
   - `Received offer` が表示されたか

---

**最終更新**: 2025年10月10日 00:40
